<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/style.css">

    <script type="text/javascript" src="js/mootools-core-1.4.5-full-compat.js"></script>
    <script type="text/javascript" src="js/mootools-more-1.4.0.1.js"></script>
    <script type="text/javascript" src="js/moo-pin.js"></script>
    <script type="text/javascript">
      window.addEvent('load', function(){
        var pins = new MooPin({
          container: 'main',
        });
      });

      /* Load Event fires when the whole page is loaded, included all images */
      window.addEvent('load', function() {
        var main_contet = $('main');
        var column_size = main_contet.getElement('.item').getSize();
        var col_width = column_size.x;
        var col_margin = 20;
        var widthParent = main_contet.getElement('.tiles').getSize().x + 20;

        console.log(widthParent);

        var totalElementsCanFit = (widthParent / ( col_width + col_margin )).toInt();

        var array_Height = new Array(totalElementsCanFit);
        var item_elements = main_contet.getElements('.item');
        var theIndex = 0;
        var tiles_position = main_contet.getElement('.tiles').getPosition(main_contet);

        var leftPosition = tiles_position.x;
        var topPosition = tiles_position.y;
        var item_size = 0;
        var min_value = 0;

        for (var i = 0; i < array_Height.length ; i++) {
          array_Height[i] = 0;
        }

        item_elements.each(function(item, index) {
          theIndex = index % totalElementsCanFit;
          item_size = item.getSize();

          min_value = array_Height.min();
          index_of_min = array_Height.indexOf(min_value);

          topPosition = min_value;
          leftPosition = (item_size.x + col_margin) * (index_of_min);
          array_Height[index_of_min] = array_Height[index_of_min] + 20 + item_size.y;

          console.log({
            top: topPosition + 'px',
            left: leftPosition + 'px',
            position: 'absolute'
          });

          item.setStyles({
            top: topPosition + 'px',
            left: leftPosition + 'px',
            position: 'absolute'
          });
        });
      });
    </script>

    <title>Basic Usage</title>
  </head>
  <body>
    <div class="container">
      <div class="page-header">
        <h1> Moo Pins </h1>
        <div class="main" id="main">
          <div class="tiles">
            <div class="item"><img src="sample-images/image_1.jpg" width="200" height="283"><p>1</p></div>
            <div class="item"><img src="sample-images/image_2.jpg" width="200" height="300"><p>2</p></div>
            <div class="item"><img src="sample-images/image_3.jpg" width="200" height="252"><p>3</p></div>
            <div class="item"><img src="sample-images/image_4.jpg" width="200" height="158"><p>4</p></div>
            <div class="item"><img src="sample-images/image_5.jpg" width="200" height="300"><p>5</p></div>
            <div class="item"><img src="sample-images/image_6.jpg" width="200" height="297"><p>6</p></div>
            <div class="item"><img src="sample-images/image_7.jpg" width="200" height="200"><p>7</p></div>
            <div class="item"><img src="sample-images/image_8.jpg" width="200" height="200"><p>8</p></div>
            <div class="item"><img src="sample-images/image_9.jpg" width="200" height="398"><p>9</p></div>
            <div class="item"><img src="sample-images/image_4.jpg" width="200" height="158"><p>4</p></div>
            <div class="item"><img src="sample-images/image_5.jpg" width="200" height="300"><p>5</p></div>
            <div class="item"><img src="sample-images/image_6.jpg" width="200" height="297"><p>6</p></div>
            <div class="item"><img src="sample-images/image_7.jpg" width="200" height="200"><p>7</p></div>
            <div class="item"><img src="sample-images/image_8.jpg" width="200" height="200"><p>8</p></div>
            <div class="item"><img src="sample-images/image_9.jpg" width="200" height="398"><p>9</p></div>
            <div class="item"><img src="sample-images/image_4.jpg" width="200" height="158"><p>4</p></div>
            <div class="item"><img src="sample-images/image_5.jpg" width="200" height="300"><p>5</p></div>
            <div class="item"><img src="sample-images/image_6.jpg" width="200" height="297"><p>6</p></div>
            <div class="item"><img src="sample-images/image_7.jpg" width="200" height="200"><p>7</p></div>
            <div class="item"><img src="sample-images/image_8.jpg" width="200" height="200"><p>8</p></div>
            <div class="item"><img src="sample-images/image_9.jpg" width="200" height="398"><p>9</p></div>
            <div class="item"><img src="sample-images/image_1.jpg" width="200" height="283"><p>1</p></div>
            <div class="item"><img src="sample-images/image_2.jpg" width="200" height="300"><p>2</p></div>
            <div class="item"><img src="sample-images/image_3.jpg" width="200" height="252"><p>3</p></div>
            <div class="item"><img src="sample-images/image_4.jpg" width="200" height="158"><p>4</p></div>
            <div class="item"><img src="sample-images/image_5.jpg" width="200" height="300"><p>5</p></div>
            <div class="item"><img src="sample-images/image_6.jpg" width="200" height="297"><p>6</p></div>
            <div class="item"><img src="sample-images/image_7.jpg" width="200" height="200"><p>7</p></div>            
          </div>
        </div>
      </div>
    </div>
  </body>
</html>